## US1003 - As Sales Clerk, I want to register a new customer.
=======================================

# 1. Requisitos

**US1003.** As Sales Clerk, I want to register a new customer.

* US1003.1 Iniciar o registo de um novo cliente por parte do Sales Clerk, indicando toda a informação necessária (name, VAT - Value Added Tax identifier, email, adress, phone number, entre outros ... )

* US1003.2 Acrescentar informação adicional no registo do cliente de modo a conter um utilizador mais completo, nomeadamente dados como data de nascimento, género, billing e delivering postal adress.

* US1003.3 Necessidade de gerar automáticamente um identificador único no processo de registo do novo customer após validação dos dados pelo Sales Clerk.


## 1.1 Interpretação dos Requisitos


Com base na informação disponibilizada pelo cliente, no conjunto de user stories requisitados pelo mesmo para este Sprint B, na discussão dos requisitos com o próprio cliente no fórum apropriado, assim como dos restantes membros da equipa de trabalho, interpretou-se esta user story da seguinte forma:

*  A customer registration might be done by three distinct ways:

   ** The customer accesses the application (without being authenticated) and proceeds to his/herself registration The customer account needs to be further activated, otherwise the customer cannot access the system.

   ** Customers info might be imported from a text file generated by an external system. Multiple text file formats need to be supported (e.g.: CSV, XML).

   ** Alternativamente, e de modo a cumprir com esta user story, the registration can be manually performed by a clerk. No account activation is required.


*  Regarding customers, the minimum required information is its name, a valid Value-Added Tax (VAT) identifier, an email, an address, and a phone number.

* Optionally, customers might state their birthdate and gender and have/manage several billing and delivering postal addresses.

* Every customer also has a unique identifier that is automatically generated by the system at the customer registration time.


* Para além disto, devemos ter em consideração que somos requisitados to conceive/design/implement a generic base solution that can be easily reused on other systems/domains.

* Esta user story vai ser concebida numa aplicação a correr no servidores e nos computadores da empresa pelo que devemos ter em conta todos os aspetos necessários ao seu bom funcionamento.



# 2. Análise

## 2.1 Identificação de conceitos

* **[Entidade] Customer**
   * [ValueObject] customerId
   * [ValueObject] customerName
   * [ValueObject] customerVAT
   * [ValueObject] customerPhone
   * [ValueObject] customerBirthdate
   * [ValueObject] customerAddress
   * [ValueObject] customerEmail


## 2.2 Invariantes/Regras de negócio

Customer Features:

- Name -
   * At least a first and last name is required.
   * Although, desirably the customer should specify his/her full name.
   * Apply the min/max length reasonable to meet this requirement.

- VAT -
   * Varies from one country to another.
   * Usually it has letters and numbers.
   * The system must be prepared to support/recognize several VAT IDs.

- Phone number -
   * According to international standards (e.g.: +351 934 563 123).

- Birthdate -
   * Adopt year/month/day mask.

- Address -
   * It must contain street name, door number, postal code, city, country.

- Email -
   * It must be a valid email.

- Identifier -
   * Unique and generated automatically by the system when registering new customer.


## 2.3 Modelação no Modelo de Domínio



Através da comparação da análise feita nesta secção com a modelação feita no Modelo de Domínio anteriormente, concluiu-se que o Modelo de Domínio consegue responder aos requisitos do cliente para esta User Story.



# 3. Design


## 3.1. Realização da Funcionalidade

De acordo com a análise realizada anteriormente, e os requisitos do cliente, é possível concluir que a funcionalidade pedida é relevante no desenrolar do nosso sistema pelo que é deveras importante que todos os detalhes da mesma sejam bem específicados.

Como tal, optou-se por representar o modo de funcionamento desta funcionalidade sob a forma de um Diagrama de Sequência UML.


### _3.1.1 Diagrama Genérico_




## 3.2. Diagrama de Classes


Na fase de análise já foram identificados os conceitos de domínio (Entidades, ValueObjects, etc.) associados a esta funcionalidade. Todas esses conceitos serão representados por classes respetivas, e são então parte fundamental desta funcionalidade.

No entanto, foram identificadas várias outras classes, que apesar de não serem conceitos de domínio, são também fundamentais para esta User Story.


**_Camada de Presentation_**

UI - A User Interface, que conduz a User Story e vai interagindo com o utilizador.

**_Camada de Application_**

Controller - O controlador da User Story que delega tarefas às outras classes.

**_Camada de Domain_**

Todas as classes referentes a conceitos identificados na fase de análise:
Customer
customerId
customerName
customerVAT
customerPhone
customerBirthdate
customerAddress
customerEmail

**_Camada de Persistence_**
_Repositories tem o objetivo de encarregarem-se da persistência dos dados modificados durante a utilização das funcionalidades da aplicação, e do levantamento desses mesmo dados quando necessário:_


## 3.3. Padrões Aplicados

Considerei três padrões qu estão interligados, e foram sempre tendo sido em mente durante o Design, pelo que foram aplicados em diversos contextos.

### 3.3.1 Information Expert

* Information Expert
   * A classe Customer é quem melhor conhece os seus atributos, pelo que é a classe mais indicada para realizar verificação dos seus atributos de acordo com os dados recebidos.

### 3.3.2 Tell, don't ask

* Tell, don't ask
   * O Controller, em vez de pedir (ask) informação a outras classes e executar lógica de negócio, apenas diz (tell) às classes melhor indicadas para a tarefa o que pretende.

### 3.3.3 Single Responsability Principle

* Single Responsability Principle
   * A função fundamental da classe de UI é de interagir com o utilizador. Ou seja, cada classe tem apenas a responsabilidade fundamental que lhe compete.


